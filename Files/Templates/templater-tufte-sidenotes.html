<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>templater-tufte-sidenotes - notes TestLab</title>
    <link rel="stylesheet" href="/mwb-static/css/mystyles.css">
    <link rel="stylesheet" href="/mwb-static/css/markdown.css">
    <link rel="stylesheet" href="/mwb-static/css/sidebar.css">
    <link rel="stylesheet" href="/mwb-static/css/custom.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>
    <script src="/lunr-index-1717432984.1574693.js"></script>
    <script>var index = lunr.Index.load(lunr_index)</script>
    
    
    <script src="/lunr-posts-1717432984.1574693.js"></script>
    
  </head>
  <body class="has-navbar-fixed-top">
    <nav class="navbar is-fixed-top is-info" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <div class="is-size-3 is-uppercase has-text-weight-light">notes TestLab</div>
    </a>

    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasic">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasic" class="navbar-menu">
    <div class="navbar-start">
      <div class="navbar-item">
	<div class="buttons">
	  <a class="button is-primary" href="/">
	    <strong>Home</strong>
	  </a>
	  <a class="button is-light" href="/all-pages.html">
	    All Pages
	  </a>
	  
	  <a class="button is-light" onclick="location.href=lunr_posts[Math.floor(Math.random() * lunr_posts.length)].link">
	    Random Page
	  </a>
	  
	  
	  <a class="button is-light" href="/search.html">
	    Search
	  </a>
	  
	</div>
      </div>
    </div>

    <div class="navbar-end">
      <div class="navbar-item">
      </div>
    </div>
  </div>
</nav>
    <section class="section">
      <div class="container">
	<div class="columns">
	  <div class="sidebar column is-one-fifth">
            <div class="content markdown-body" style="border-right:1px black solid; padding-right:1em;">
              <h1>Site Navigation</h1>
<p><a class="wikilink" href="/README.html">Home</a></p>
<p><a href="/search.html">Search</a><br />
<a href="/all-pages.html">All Pages</a></p>
<h2>A wiki page of note</h2>
<p><a class="wikilink" href="/A.R._Moxon_-_What_is_a_socialist.html">A.R. Moxon - What is a socialist</a></p>

            </div>
	  </div>
	  <div class="column">
            <div class="content markdown-body">
              <p>&lt;%*
/*
Author: TfTHacker - more info  https://tfthacker.com/
Date:   2023-08-13
LICENSE: Copyright Â© 2023 TfThacker (https://tfthacker.com/)  You are granted a non-exclusive, non-transferable,
and non-sublicensable license to use and modify this file for your personal use only, and are prohibited from
distributing, sublicensing, using for commercial purposes. This file remain the property of TfTHacker, and any unauthorized
use or infringement will result in termination of this License. This file are provided &quot;AS IS&quot; without warranty of any kind,
and the Licensor shall not be liable for any damages arising from the use or distribution of this file. By using this file,
you acknowledge that you have read, understand, and agree to be bound by this License Agreement.
*/</p>
<p>/*
Notes:</p>
<ul>
<li>TABLES: Work in tables, but links are buggy</li>
<li>LISTS: footnotes are only supported in the first level of list, no in child nodes</li>
<li>Sidenotes will overlap with footnotes from other document sections</li>
<li>create a template to add Tufte footnote to cssclasses</li>
<li>no support for embedded content</li>
<li>sidenotes can disappear while editing. they usually appear after reopening file or continuing to edit document outside of current section. This is due to waiting for Obsidian to update the footer section.
*/</li>
</ul>
<p>console.log(&quot;Loading Tufte Sidenotes Processor&quot;);</p>
<p>const templaterPlugin = app.plugins.getPlugin('templater-obsidian').templater;</p>
<p>//if script is reloaded, unregister the Markdown procesor
try {
templaterPlugin.current_functions_object.obsidian.MarkdownPreviewRenderer.unregisterPostProcessor(window.TufteSidenote.MarkdownPostProcessor);
} catch (error) { }</p>
<p>window.TufteSidenote = {};
window.TufteSidenote.footnotes = {};
window.TufteSidenote.sidenotes = {};</p>
<p>// The Obsidian base class
class Component {
load() {}
onload() {}
unload() {}
}</p>
<p>class SidenoteRenderer extends Component {
constructor(el, ctx) {
super(el);
this.ctx = ctx;
}</p>
<p>// Adds each footnote by section into a container with the class name tufte-sidenotes-collection
// this class will align the footnotes to the right and stack them using a flex grid
processFootnotes(el, docId, exportToPDF=false) {
for (const fRef of Array.from(el.querySelectorAll(&quot;sup.footnote-ref&quot;))) {
const footnoteId = fRef.id.replace(&quot;fnref&quot;, &quot;fn&quot;);</p>
<pre><code>  
  // Deetermine what should be the parent node for the sidenotes container
  let collectionParentNode;
  if(fRef.parentNode.nodeName===&quot;LI&quot;) { //if in a list, only support the first level
    if(fRef.parentNode.parentNode.parentNode.nodeName===&quot;DIV&quot;)
      collectionParentNode = fRef.parentNode;
  } else if(fRef.parentNode.nodeName===&quot;TD&quot;) //if a table
    collectionParentNode = fRef.parentNode;
  else // default paragraph text flow
    collectionParentNode = exportToPDF ? fRef.parentNode : fRef.parentNode.parentNode;

  // Collection of footnotes
  let sidenotesCollectionEl;
  if(collectionParentNode?.querySelector(&quot;.tufte-sidenotes-collection&quot;)) {
    sidenotesCollectionEl = collectionParentNode.querySelector(&quot;.tufte-sidenotes-collection&quot;)
  } else {
    sidenotesCollectionEl = document.createElement(&quot;div&quot;);
    sidenotesCollectionEl.classList.add(&quot;tufte-sidenotes-collection&quot;);
    collectionParentNode?.insertBefore(sidenotesCollectionEl, collectionParentNode.firstChild);
  }
                            
  const sidenoteEl = document.createElement(&quot;div&quot;);
  sidenoteEl.classList.add(&quot;tufte-sidenote&quot;);
  sidenoteEl.setAttribute(&quot;tufte-fn-Id&quot;, footnoteId);
  sidenotesCollectionEl.appendChild(sidenoteEl);

  try {
    if(exportToPDF===false) {
      (window.TufteSidenote.sidenotes[docId] ??= []).push(sidenoteEl);
    }
    formatFootnote(sidenoteEl, footnoteId, window.TufteSidenote.footnotes[docId][footnoteId].html);
  } catch (error) { }
}
</code></pre>
<p>}</p>
<p>load() {
super.load();
// contains(&quot;markdown-rendered&quot;) true when doing an export to PDF
this.processFootnotes(this.ctx.el, this.ctx.docId, this.ctx.el.classList.contains(&quot;markdown-rendered&quot;));
}</p>
<p>onunload() { super.onunload() }</p>
<p>unload() {
super.unload();
const docId = this.ctx.docId;
const rs = window.TufteSidenote.sidenotes[docId] ??= [];
rs.remove(this)
if (rs.length &lt;= 0) {
delete window.TufteSidenote.sidenotes[docId];
delete window.TufteSidenote.footnotes[docId];
}
}</p>
<p>} //END: SidenoteRenderer</p>
<p>const formatFootnote = (el, footnoteId, innerHTML) =&gt; {
const footnoteNumber = footnoteId.match(/(?&lt;=fn-)\d+(?=-)/)[0];
el.innerHTML = <code>&lt;span class=&quot;tufte-footnote-number&quot;&gt;${footnoteNumber}&lt;/span&gt;</code> + innerHTML;
el.querySelector(&quot;a.footnote-backref.footnote-link&quot;).remove();
}</p>
<p>window.TufteSidenote.MarkdownPostProcessor = async (el, ctx)=&gt; {</p>
<p>// Test if the document has the proper css classed defined. It needs:
// - tufte-sidenotes
// - either cornell-left or cornell-right
if(ctx.frontmatter===undefined) return;
let cssclasses = ctx.frontmatter[&quot;cssclass&quot;];
if(cssclasses===undefined) cssclasses = ctx.frontmatter[&quot;cssclasses&quot;]; // make compatible with Obsidian 1.4.1+</p>
<p>if(!cssclasses?.includes(&quot;tufte-sidenotes&quot;)) return;
if(!cssclasses?.includes(&quot;cornell-left&quot;) &amp;&amp; !cssclasses?.includes(&quot;cornell-right&quot;)) return;</p>
<p>// Detect if there are footnotes.
// If using Export To PDF, the el element has a class called markdown-rendered
// - This means el is the entire document, not section by section as normally handled by MarkdownPostProcessor
// if this class doesn't exist, the footnotes are not process until all other sections are process
// - for this reason we add an empty div for the footnote, then after footnotes section is processed, the
//   empty food note divs are updated with the html of the footnote
// Long story short, we have to process &quot;screen&quot; and &quot;Export to PDF&quot; differently in rendering
const footnotes = el.querySelectorAll(&quot;.footnotes li&quot;);
if(footnotes.length&gt;0) {
window.TufteSidenote.footnotes[ctx.docId]={}
for(const footnote of footnotes) {
// Save footnotes for later processing
window.TufteSidenote.footnotes[ctx.docId][footnote.id] = {
html: footnote.innerHTML
}
// if NOT exporting to PDF, update the footnotes
if(!el.classList.contains(&quot;markdown-rendered&quot;))
for(sidenoteEl of window.TufteSidenote.sidenotes[ctx.docId])
if(sidenoteEl.getAttribute(&quot;tufte-fn-Id&quot;)===footnote.id)
formatFootnote(sidenoteEl, footnote.id, footnote.innerHTML);
} // END: for
} // END: if</p>
<p>ctx.addChild(new SidenoteRenderer(el, ctx));</p>
<p>}</p>
<p>templaterPlugin.plugin.registerMarkdownPostProcessor(window.TufteSidenote.MarkdownPostProcessor);</p>
<p>%&gt;</p>

	      
            </div>
	  </div>
	</div>
      </div>
    </section>
    <footer class="footer">
  <div class="content has-text-centered">
    <div><strong>notes TestLab</strong> by the unpaid anderbill.</div>
    <div>Central repository at <a href="https://github.com//band/notesTestLab.git">GitHub/band/notesTestLab</a>.</div>
    <div>Licensed under <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div>
    <div><em>Site last updated on Monday, June 03, 2024 at 16:43 UTC.</em></div>
  </div>
</footer>
    <script>// ensure the DOM is loaded, for things that need it
document.addEventListener('DOMContentLoaded', () => {

  ////////////////////////////////////////////////////////////////
  // Bulma navbar helpers
  ////////////////////////////////////////////////////////////////

  // Get all "navbar-burger" elements
  const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

  // Check if there are any navbar burgers
  if ($navbarBurgers.length > 0) {

    // Add a click event on each of them
    $navbarBurgers.forEach( el => {
      el.addEventListener('click', () => {

        // Get the target from the "data-target" attribute
        const target = el.dataset.target;
        const $target = document.getElementById(target);

        // Toggle the "is-active" class on both the "navbar-burger" and the "navbar-menu"
        el.classList.toggle('is-active');
        $target.classList.toggle('is-active');

      });
    });
  }

});</script>
    <script src="https://hypothes.is/embed.js" async></script>
  </body>
</html>